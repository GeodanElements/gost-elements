<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../vaadin-grid/vaadin-grid.html">

<dom-module id="gost-table">
    <template>
        <vaadin-grid id="grid" selection='{{selection}}'>
		  <table>
		  </table>
		</vaadin-grid>
    </template>
</dom-module>

<script>

Polymer({
    is: 'gost-table',
    properties: {
        resultarray: {
        	type: Array,
        	observer: '_dataChanged'
        },
        columns: {
        	type: Array
        },
        selection: {
        	type: Object,
        	observer: '_selectionChanged'
        }
    },
    ready: function(){
    	var self = this;
		this.$.grid.addEventListener('selected-items-changed', function() {
			self.$.grid.selection.selected(function(i){
				self.fire('page-change',self.resultarray.value[i]);
		  	});
		});
    },
    _selectedChanged: function(i){
    	debugger;
    },
    _dataChanged: function(){
    	var self = this;
    	this.$.grid.columns = this.columns.map(function(d){
    			return {name: d.title};
    	});
    	
    	this.$.grid.items = this.resultarray.value.map(function(d){
    			return self.columns.map(function(c){
    					switch (c.type) {
							case Object:
								return JSON.stringify(d[c.key]);
								break;
							default:
								return d[c.key];
    					}
    			});
    	});
    }
});
</script>
